!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Scroller={})}(this,function(e){"use strict";var t,v=Date.now||function(){return+new Date},T={},o=1,r=window,S={requestAnimationFrame:function(){var o=r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame,e=!!o;if(o&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(o.toString())&&(e=!1),e)return function(e,t){o(e,t)};var i={},n=1,_=null,l=+new Date;return function(e,t){var o=n++;return i[o]=e,null===_&&(_=setInterval(function(){var e=+new Date,t=i;for(var o in i={},t)t.hasOwnProperty(o)&&(t[o](e),l=e);2500<e-l&&(clearInterval(_),_=null)},1e3/60)),o}}(),stop:function(e){var t=null!=T[e];return t&&(T[e]=null),t},isRunning:function(e){return null!=T[e]},start:function(l,r,a,c,s,h){var p=v(),u=p,m=0,f=0,g=o++;if(h||(h=document.body),g%20==0){var e={};for(var t in T)e[t]=!0;T=e}var d=function(e){var t=!0!==e,o=v();if(!T[g]||r&&!r(g))return T[g]=null,void(a&&a(60-f/((o-p)/1e3),g,!1));if(t)for(var i=Math.round((o-u)/(1e3/60))-1,n=0;n<Math.min(i,4);n++)d(!0),f++;c&&1<(m=(o-p)/c)&&(m=1);var _=s?s(m):m;!1!==l(_,o,t)&&1!==m||!t?t&&(u=o,S.requestAnimationFrame(d,h)):(T[g]=null,a&&a(60-f/((o-p)/1e3),g,1===m||null==c))};return T[g]=!0,S.requestAnimationFrame(d,h),g}},i=function(){},p=function(e){return Math.pow(e-1,3)+1},u=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},n={__isSingleTouch:!(t=function(e,t){for(var o in this.__callback=e,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:i,penetrationDeceleration:.03,penetrationAcceleration:.08},t)this.options[o]=t[o]}),__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(e,t,o,i){var n=this;e===+e&&(n.__clientWidth=e),t===+t&&(n.__clientHeight=t),o===+o&&(n.__contentWidth=o),i===+i&&(n.__contentHeight=i),n.__computeScrollMax(),n.scrollTo(n.__scrollLeft,n.__scrollTop,!0)},setPosition:function(e,t){this.__clientLeft=e||0,this.__clientTop=t||0},setSnapSize:function(e,t){this.__snapWidth=e,this.__snapHeight=t},activatePullToRefresh:function(e,t,o,i){this.__refreshHeight=e,this.__refreshActivate=t,this.__refreshDeactivate=o,this.__refreshStart=i},triggerPullToRefresh:function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart&&this.__refreshStart()},finishPullToRefresh:function(){var e=this;e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},getValues:function(){return{left:this.__scrollLeft,top:this.__scrollTop,zoom:this.__zoomLevel}},getScrollMax:function(){return{left:this.__maxScrollLeft,top:this.__maxScrollTop}},zoomTo:function(e,t,o,i,n){var _=this;if(!_.options.zooming)throw new Error("Zooming is not enabled!");n&&(_.__zoomComplete=n),_.__isDecelerating&&(S.stop(_.__isDecelerating),_.__isDecelerating=!1);var l=_.__zoomLevel;null==o&&(o=_.__clientWidth/2),null==i&&(i=_.__clientHeight/2),e=Math.max(Math.min(e,_.options.maxZoom),_.options.minZoom),_.__computeScrollMax(e);var r=(o+_.__scrollLeft)*e/l-o,a=(i+_.__scrollTop)*e/l-i;r>_.__maxScrollLeft?r=_.__maxScrollLeft:r<0&&(r=0),a>_.__maxScrollTop?a=_.__maxScrollTop:a<0&&(a=0),_.__publish(r,a,e,t)},zoomBy:function(e,t,o,i,n){this.zoomTo(this.__zoomLevel*e,t,o,i,n)},scrollTo:function(e,t,o,i){var n=this;if(n.__isDecelerating&&(S.stop(n.__isDecelerating),n.__isDecelerating=!1),null!=i&&i!==n.__zoomLevel){if(!n.options.zooming)throw new Error("Zooming is not enabled!");e*=i,t*=i,n.__computeScrollMax(i)}else i=n.__zoomLevel;n.options.scrollingX?n.options.paging?e=Math.round(e/n.__clientWidth)*n.__clientWidth:n.options.snapping&&(e=Math.round(e/n.__snapWidth)*n.__snapWidth):e=n.__scrollLeft,n.options.scrollingY?n.options.paging?t=Math.round(t/n.__clientHeight)*n.__clientHeight:n.options.snapping&&(t=Math.round(t/n.__snapHeight)*n.__snapHeight):t=n.__scrollTop,e=Math.max(Math.min(n.__maxScrollLeft,e),0),t=Math.max(Math.min(n.__maxScrollTop,t),0),e===n.__scrollLeft&&t===n.__scrollTop&&(o=!1),n.__isTracking||n.__publish(e,t,i,o)},scrollBy:function(e,t,o){var i=this,n=i.__isAnimating?i.__scheduledLeft:i.__scrollLeft,_=i.__isAnimating?i.__scheduledTop:i.__scrollTop;i.scrollTo(n+(e||0),_+(t||0),o)},doMouseZoom:function(e,t,o,i){var n=0<e?.97:1.03;return this.zoomTo(this.__zoomLevel*n,!1,o-this.__clientLeft,i-this.__clientTop)},doTouchStart:function(e,t){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var o,i,n=this;n.__interruptedAnimation=!0,n.__isDecelerating&&(S.stop(n.__isDecelerating),n.__isDecelerating=!1,n.__interruptedAnimation=!0),n.__isAnimating&&(S.stop(n.__isAnimating),n.__isAnimating=!1,n.__interruptedAnimation=!0);var _=1===e.length;_?(o=e[0].pageX,i=e[0].pageY):(o=Math.abs(e[0].pageX+e[1].pageX)/2,i=Math.abs(e[0].pageY+e[1].pageY)/2),n.__initialTouchLeft=o,n.__initialTouchTop=i,n.__zoomLevelStart=n.__zoomLevel,n.__lastTouchLeft=o,n.__lastTouchTop=i,n.__lastTouchMove=t,n.__lastScale=1,n.__enableScrollX=!_&&n.options.scrollingX,n.__enableScrollY=!_&&n.options.scrollingY,n.__isTracking=!0,n.__didDecelerationComplete=!1,n.__isDragging=!_,n.__isSingleTouch=_,n.__positions=[]},doTouchMove:function(e,t,o){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var i=this;if(i.__isTracking){var n,_;2===e.length?(n=Math.abs(e[0].pageX+e[1].pageX)/2,_=Math.abs(e[0].pageY+e[1].pageY)/2):(n=e[0].pageX,_=e[0].pageY);var l=i.__positions;if(i.__isDragging){var r=n-i.__lastTouchLeft,a=_-i.__lastTouchTop,c=i.__scrollLeft,s=i.__scrollTop,h=i.__zoomLevel;if(null!=o&&i.options.zooming){var p=h;if(h=h/i.__lastScale*o,p!==(h=Math.max(Math.min(h,i.options.maxZoom),i.options.minZoom))){var u=n-i.__clientLeft,m=_-i.__clientTop;c=(u+c)*h/p-u,s=(m+s)*h/p-m,i.__computeScrollMax(h)}}if(i.__enableScrollX){c-=r*this.options.speedMultiplier;var f=i.__maxScrollLeft;(f<c||c<0)&&(i.options.bouncing?c+=r/2*this.options.speedMultiplier:c=f<c?f:0)}if(i.__enableScrollY){s-=a*this.options.speedMultiplier;var g=i.__maxScrollTop;(g<s||s<0)&&(i.options.bouncing?(s+=a/2*this.options.speedMultiplier,i.__enableScrollX||null==i.__refreshHeight||(!i.__refreshActive&&s<=-i.__refreshHeight?(i.__refreshActive=!0,i.__refreshActivate&&i.__refreshActivate()):i.__refreshActive&&s>-i.__refreshHeight&&(i.__refreshActive=!1,i.__refreshDeactivate&&i.__refreshDeactivate()))):s=g<s?g:0)}60<l.length&&l.splice(0,30),l.push(c,s,t),i.__publish(c,s,h)}else{var d=i.options.locking?3:0,v=Math.abs(n-i.__initialTouchLeft),T=Math.abs(_-i.__initialTouchTop);i.__enableScrollX=i.options.scrollingX&&d<=v,i.__enableScrollY=i.options.scrollingY&&d<=T,l.push(i.__scrollLeft,i.__scrollTop,t),i.__isDragging=(i.__enableScrollX||i.__enableScrollY)&&(5<=v||5<=T),i.__isDragging&&(i.__interruptedAnimation=!1)}i.__lastTouchLeft=n,i.__lastTouchTop=_,i.__lastTouchMove=t,i.__lastScale=o}},doTouchEnd:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var t=this;if(t.__isTracking){if(t.__isTracking=!1,t.__isDragging)if(t.__isDragging=!1,t.__isSingleTouch&&t.options.animating&&e-t.__lastTouchMove<=100){for(var o=t.__positions,i=o.length-1,n=i,_=i;0<_&&o[_]>t.__lastTouchMove-100;_-=3)n=_;if(n!==i){var l=o[i]-o[n],r=t.__scrollLeft-o[n-2],a=t.__scrollTop-o[n-1];t.__decelerationVelocityX=r/l*(1e3/60),t.__decelerationVelocityY=a/l*(1e3/60);var c=t.options.paging||t.options.snapping?4:1;Math.abs(t.__decelerationVelocityX)>c||Math.abs(t.__decelerationVelocityY)>c?t.__refreshActive||t.__startDeceleration(e):t.options.scrollingComplete()}else t.options.scrollingComplete()}else 100<e-t.__lastTouchMove&&t.options.scrollingComplete();t.__isDecelerating||(t.__refreshActive&&t.__refreshStart?(t.__publish(t.__scrollLeft,-t.__refreshHeight,t.__zoomLevel,!0),t.__refreshStart&&t.__refreshStart()):((t.__interruptedAnimation||t.__isDragging)&&t.options.scrollingComplete(),t.scrollTo(t.__scrollLeft,t.__scrollTop,!0,t.__zoomLevel),t.__refreshActive&&(t.__refreshActive=!1,t.__refreshDeactivate&&t.__refreshDeactivate()))),t.__positions.length=0}},__publish:function(e,t,o,i){var n=this,_=n.__isAnimating;if(_&&(S.stop(_),n.__isAnimating=!1),i&&n.options.animating){n.__scheduledLeft=e,n.__scheduledTop=t,n.__scheduledZoom=o;var l=n.__scrollLeft,r=n.__scrollTop,a=n.__zoomLevel,c=e-l,s=t-r,h=o-a;n.__isAnimating=S.start(function(e,t,o){o&&(n.__scrollLeft=l+c*e,n.__scrollTop=r+s*e,n.__zoomLevel=a+h*e,n.__callback&&n.__callback(n.__scrollLeft,n.__scrollTop,n.__zoomLevel))},function(e){return n.__isAnimating===e},function(e,t,o){t===n.__isAnimating&&(n.__isAnimating=!1),(n.__didDecelerationComplete||o)&&n.options.scrollingComplete(),n.options.zooming&&(n.__computeScrollMax(),n.__zoomComplete&&(n.__zoomComplete(),n.__zoomComplete=null))},n.options.animationDuration,_?p:u)}else n.__scheduledLeft=n.__scrollLeft=e,n.__scheduledTop=n.__scrollTop=t,n.__scheduledZoom=n.__zoomLevel=o,n.__callback&&n.__callback(e,t,o),n.options.zooming&&(n.__computeScrollMax(),n.__zoomComplete&&(n.__zoomComplete(),n.__zoomComplete=null))},__computeScrollMax:function(e){var t=this;null==e&&(e=t.__zoomLevel),t.__maxScrollLeft=Math.max(t.__contentWidth*e-t.__clientWidth,0),t.__maxScrollTop=Math.max(t.__contentHeight*e-t.__clientHeight,0)},__startDeceleration:function(e){var i=this;if(i.options.paging){var t=Math.max(Math.min(i.__scrollLeft,i.__maxScrollLeft),0),o=Math.max(Math.min(i.__scrollTop,i.__maxScrollTop),0),n=i.__clientWidth,_=i.__clientHeight;i.__minDecelerationScrollLeft=Math.floor(t/n)*n,i.__minDecelerationScrollTop=Math.floor(o/_)*_,i.__maxDecelerationScrollLeft=Math.ceil(t/n)*n,i.__maxDecelerationScrollTop=Math.ceil(o/_)*_}else i.__minDecelerationScrollLeft=0,i.__minDecelerationScrollTop=0,i.__maxDecelerationScrollLeft=i.__maxScrollLeft,i.__maxDecelerationScrollTop=i.__maxScrollTop;var l=i.options.snapping?4:.001;i.__isDecelerating=S.start(function(e,t,o){i.__stepThroughDeceleration(o)},function(){var e=Math.abs(i.__decelerationVelocityX)>=l||Math.abs(i.__decelerationVelocityY)>=l;return e||(i.__didDecelerationComplete=!0),e},function(e,t,o){i.__isDecelerating=!1,i.__didDecelerationComplete&&i.options.scrollingComplete(),i.scrollTo(i.__scrollLeft,i.__scrollTop,i.options.snapping)})},__stepThroughDeceleration:function(e){var t=this,o=t.__scrollLeft+t.__decelerationVelocityX,i=t.__scrollTop+t.__decelerationVelocityY;if(!t.options.bouncing){var n=Math.max(Math.min(t.__maxDecelerationScrollLeft,o),t.__minDecelerationScrollLeft);n!==o&&(o=n,t.__decelerationVelocityX=0);var _=Math.max(Math.min(t.__maxDecelerationScrollTop,i),t.__minDecelerationScrollTop);_!==i&&(i=_,t.__decelerationVelocityY=0)}if(e?t.__publish(o,i,t.__zoomLevel):(t.__scrollLeft=o,t.__scrollTop=i),!t.options.paging){t.__decelerationVelocityX*=.95,t.__decelerationVelocityY*=.95}if(t.options.bouncing){var l=0,r=0,a=t.options.penetrationDeceleration,c=t.options.penetrationAcceleration;o<t.__minDecelerationScrollLeft?l=t.__minDecelerationScrollLeft-o:o>t.__maxDecelerationScrollLeft&&(l=t.__maxDecelerationScrollLeft-o),i<t.__minDecelerationScrollTop?r=t.__minDecelerationScrollTop-i:i>t.__maxDecelerationScrollTop&&(r=t.__maxDecelerationScrollTop-i),0!==l&&(l*t.__decelerationVelocityX<=0?t.__decelerationVelocityX+=l*a:t.__decelerationVelocityX=l*c),0!==r&&(r*t.__decelerationVelocityY<=0?t.__decelerationVelocityY+=r*a:t.__decelerationVelocityY=r*c)}}};for(var _ in n)t.prototype[_]=n[_];var l=t,a=function(e,t,o){this.content=e,this.container=e.parentNode,this.options=o||{},this.render=t;var i=this;this.scroller=new l(function(e,t,o){i.render(e,t,o)},o),this.bindEvents(),this.content.style[a.vendorPrefix+"TransformOrigin"]="left top",this.reflow()};a.prototype.reflow=function(){this.scroller.setDimensions(this.container.clientWidth,this.container.clientHeight,this.content.offsetWidth,this.content.offsetHeight);var e=this.container.getBoundingClientRect();this.scroller.setPosition(e.left+this.container.clientLeft,e.top+this.container.clientTop)},a.prototype.bindEvents=function(){var t=this;if(window.addEventListener("resize",function(){t.reflow()},!1),"ontouchstart"in window)this.container.addEventListener("touchstart",function(e){e.touches[0]&&e.touches[0].target&&e.touches[0].target.tagName.match(/input|textarea|select/i)||(t.reflow(),t.scroller.doTouchStart(e.touches,e.timeStamp))},!1),this.container.addEventListener("touchmove",function(e){e.preventDefault(),t.scroller.doTouchMove(e.touches,e.timeStamp,e.scale)},!1),this.container.addEventListener("touchend",function(e){t.scroller.doTouchEnd(e.timeStamp)},!1),this.container.addEventListener("touchcancel",function(e){t.scroller.doTouchEnd(e.timeStamp)},!1);else{var o=!1;this.container.addEventListener("mousedown",function(e){e.target.tagName.match(/input|textarea|select/i)||(t.scroller.doTouchStart([{pageX:e.pageX,pageY:e.pageY}],e.timeStamp),o=!0,t.reflow(),e.preventDefault())},!1),document.addEventListener("mousemove",function(e){o&&(t.scroller.doTouchMove([{pageX:e.pageX,pageY:e.pageY}],e.timeStamp),o=!0)},!1),document.addEventListener("mouseup",function(e){o&&(t.scroller.doTouchEnd(e.timeStamp),o=!1)},!1),this.container.addEventListener("mousewheel",function(e){t.options.zooming&&(t.scroller.doMouseZoom(e.wheelDelta,e.timeStamp,e.pageX,e.pageY),e.preventDefault())},!1)}},e.default=l,e.Animate=S,e.EasyScroller=a});
//# sourceMappingURL=scroller.min.js.map