!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o(e.Scroller={})}(this,function(e){"use strict";var o,d=Date.now||function(){return+new Date},T={},t=1,r=window,S={requestAnimationFrame:function(){var t=r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame,e=!!t;if(t&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(t.toString())&&(e=!1),e)return function(e,o){t(e,o)};var _={},i=1,l=null,n=+new Date;return function(e,o){var t=i++;return _[t]=e,null===l&&(l=setInterval(function(){var e=+new Date,o=_;for(var t in _={},o)o.hasOwnProperty(t)&&(o[t](e),n=e);2500<e-n&&(clearInterval(l),l=null)},1e3/60)),t}}(),stop:function(e){var o=null!=T[e];return o&&(T[e]=null),o},isRunning:function(e){return null!=T[e]},start:function(n,r,a,c,s,p){var h=d(),u=h,m=0,f=0,g=t++;if(p||(p=document.body),g%20==0){var e={};for(var o in T)e[o]=!0;T=e}var v=function(e){var o=!0!==e,t=d();if(!T[g]||r&&!r(g))return T[g]=null,void(a&&a(60-f/((t-h)/1e3),g,!1));if(o)for(var _=Math.round((t-u)/(1e3/60))-1,i=0;i<Math.min(_,4);i++)v(!0),f++;c&&1<(m=(t-h)/c)&&(m=1);var l=s?s(m):m;!1!==n(l,t,o)&&1!==m||!o?o&&(u=t,S.requestAnimationFrame(v,p)):(T[g]=null,a&&a(60-f/((t-h)/1e3),g,1===m||null==c))};return T[g]=!0,S.requestAnimationFrame(v,p),g}},_=function(){},h=function(e){return Math.pow(e-1,3)+1},u=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},i={__isSingleTouch:!(o=function(e,o){for(var t in this.__callback=e,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:_,penetrationDeceleration:.03,penetrationAcceleration:.08},o)this.options[t]=o[t]}),__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(e,o,t,_){var i=this;e===+e&&(i.__clientWidth=e),o===+o&&(i.__clientHeight=o),t===+t&&(i.__contentWidth=t),_===+_&&(i.__contentHeight=_),i.__computeScrollMax(),i.scrollTo(i.__scrollLeft,i.__scrollTop,!0)},setPosition:function(e,o){this.__clientLeft=e||0,this.__clientTop=o||0},setSnapSize:function(e,o){this.__snapWidth=e,this.__snapHeight=o},activatePullToRefresh:function(e,o,t,_){this.__refreshHeight=e,this.__refreshActivate=o,this.__refreshDeactivate=t,this.__refreshStart=_},triggerPullToRefresh:function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart&&this.__refreshStart()},finishPullToRefresh:function(){var e=this;e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},getValues:function(){return{left:this.__scrollLeft,top:this.__scrollTop,zoom:this.__zoomLevel}},getScrollMax:function(){return{left:this.__maxScrollLeft,top:this.__maxScrollTop}},zoomTo:function(e,o,t,_,i){var l=this;if(!l.options.zooming)throw new Error("Zooming is not enabled!");i&&(l.__zoomComplete=i),l.__isDecelerating&&(S.stop(l.__isDecelerating),l.__isDecelerating=!1);var n=l.__zoomLevel;null==t&&(t=l.__clientWidth/2),null==_&&(_=l.__clientHeight/2),e=Math.max(Math.min(e,l.options.maxZoom),l.options.minZoom),l.__computeScrollMax(e);var r=(t+l.__scrollLeft)*e/n-t,a=(_+l.__scrollTop)*e/n-_;r>l.__maxScrollLeft?r=l.__maxScrollLeft:r<0&&(r=0),a>l.__maxScrollTop?a=l.__maxScrollTop:a<0&&(a=0),l.__publish(r,a,e,o)},zoomBy:function(e,o,t,_,i){this.zoomTo(this.__zoomLevel*e,o,t,_,i)},scrollTo:function(e,o,t,_){var i=this;if(i.__isDecelerating&&(S.stop(i.__isDecelerating),i.__isDecelerating=!1),null!=_&&_!==i.__zoomLevel){if(!i.options.zooming)throw new Error("Zooming is not enabled!");e*=_,o*=_,i.__computeScrollMax(_)}else _=i.__zoomLevel;i.options.scrollingX?i.options.paging?e=Math.round(e/i.__clientWidth)*i.__clientWidth:i.options.snapping&&(e=Math.round(e/i.__snapWidth)*i.__snapWidth):e=i.__scrollLeft,i.options.scrollingY?i.options.paging?o=Math.round(o/i.__clientHeight)*i.__clientHeight:i.options.snapping&&(o=Math.round(o/i.__snapHeight)*i.__snapHeight):o=i.__scrollTop,e=Math.max(Math.min(i.__maxScrollLeft,e),0),o=Math.max(Math.min(i.__maxScrollTop,o),0),e===i.__scrollLeft&&o===i.__scrollTop&&(t=!1),i.__isTracking||i.__publish(e,o,_,t)},scrollBy:function(e,o,t){var _=this,i=_.__isAnimating?_.__scheduledLeft:_.__scrollLeft,l=_.__isAnimating?_.__scheduledTop:_.__scrollTop;_.scrollTo(i+(e||0),l+(o||0),t)},doMouseZoom:function(e,o,t,_){var i=0<e?.97:1.03;return this.zoomTo(this.__zoomLevel*i,!1,t-this.__clientLeft,_-this.__clientTop)},doTouchStart:function(e,o){if(null==e.length)throw new Error("Invalid touch list: "+e);if(o instanceof Date&&(o=o.valueOf()),"number"!=typeof o)throw new Error("Invalid timestamp value: "+o);var t,_,i=this;i.__interruptedAnimation=!0,i.__isDecelerating&&(S.stop(i.__isDecelerating),i.__isDecelerating=!1,i.__interruptedAnimation=!0),i.__isAnimating&&(S.stop(i.__isAnimating),i.__isAnimating=!1,i.__interruptedAnimation=!0);var l=1===e.length;l?(t=e[0].pageX,_=e[0].pageY):(t=Math.abs(e[0].pageX+e[1].pageX)/2,_=Math.abs(e[0].pageY+e[1].pageY)/2),i.__initialTouchLeft=t,i.__initialTouchTop=_,i.__zoomLevelStart=i.__zoomLevel,i.__lastTouchLeft=t,i.__lastTouchTop=_,i.__lastTouchMove=o,i.__lastScale=1,i.__enableScrollX=!l&&i.options.scrollingX,i.__enableScrollY=!l&&i.options.scrollingY,i.__isTracking=!0,i.__didDecelerationComplete=!1,i.__isDragging=!l,i.__isSingleTouch=l,i.__positions=[]},doTouchMove:function(e,o,t){if(null==e.length)throw new Error("Invalid touch list: "+e);if(o instanceof Date&&(o=o.valueOf()),"number"!=typeof o)throw new Error("Invalid timestamp value: "+o);var _=this;if(_.__isTracking){var i,l;2===e.length?(i=Math.abs(e[0].pageX+e[1].pageX)/2,l=Math.abs(e[0].pageY+e[1].pageY)/2):(i=e[0].pageX,l=e[0].pageY);var n=_.__positions;if(_.__isDragging){var r=i-_.__lastTouchLeft,a=l-_.__lastTouchTop,c=_.__scrollLeft,s=_.__scrollTop,p=_.__zoomLevel;if(null!=t&&_.options.zooming){var h=p;if(p=p/_.__lastScale*t,h!==(p=Math.max(Math.min(p,_.options.maxZoom),_.options.minZoom))){var u=i-_.__clientLeft,m=l-_.__clientTop;c=(u+c)*p/h-u,s=(m+s)*p/h-m,_.__computeScrollMax(p)}}if(_.__enableScrollX){c-=r*this.options.speedMultiplier;var f=_.__maxScrollLeft;(f<c||c<0)&&(_.options.bouncing?c+=r/2*this.options.speedMultiplier:c=f<c?f:0)}if(_.__enableScrollY){s-=a*this.options.speedMultiplier;var g=_.__maxScrollTop;(g<s||s<0)&&(_.options.bouncing?(s+=a/2*this.options.speedMultiplier,_.__enableScrollX||null==_.__refreshHeight||(!_.__refreshActive&&s<=-_.__refreshHeight?(_.__refreshActive=!0,_.__refreshActivate&&_.__refreshActivate()):_.__refreshActive&&s>-_.__refreshHeight&&(_.__refreshActive=!1,_.__refreshDeactivate&&_.__refreshDeactivate()))):s=g<s?g:0)}60<n.length&&n.splice(0,30),n.push(c,s,o),_.__publish(c,s,p)}else{var v=_.options.locking?3:0,d=Math.abs(i-_.__initialTouchLeft),T=Math.abs(l-_.__initialTouchTop);_.__enableScrollX=_.options.scrollingX&&v<=d,_.__enableScrollY=_.options.scrollingY&&v<=T,n.push(_.__scrollLeft,_.__scrollTop,o),_.__isDragging=(_.__enableScrollX||_.__enableScrollY)&&(5<=d||5<=T),_.__isDragging&&(_.__interruptedAnimation=!1)}_.__lastTouchLeft=i,_.__lastTouchTop=l,_.__lastTouchMove=o,_.__lastScale=t}},doTouchEnd:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var o=this;if(o.__isTracking){if(o.__isTracking=!1,o.__isDragging)if(o.__isDragging=!1,o.__isSingleTouch&&o.options.animating&&e-o.__lastTouchMove<=100){for(var t=o.__positions,_=t.length-1,i=_,l=_;0<l&&t[l]>o.__lastTouchMove-100;l-=3)i=l;if(i!==_){var n=t[_]-t[i],r=o.__scrollLeft-t[i-2],a=o.__scrollTop-t[i-1];o.__decelerationVelocityX=r/n*(1e3/60),o.__decelerationVelocityY=a/n*(1e3/60);var c=o.options.paging||o.options.snapping?4:1;Math.abs(o.__decelerationVelocityX)>c||Math.abs(o.__decelerationVelocityY)>c?o.__refreshActive||o.__startDeceleration(e):o.options.scrollingComplete()}else o.options.scrollingComplete()}else 100<e-o.__lastTouchMove&&o.options.scrollingComplete();o.__isDecelerating||(o.__refreshActive&&o.__refreshStart?(o.__publish(o.__scrollLeft,-o.__refreshHeight,o.__zoomLevel,!0),o.__refreshStart&&o.__refreshStart()):((o.__interruptedAnimation||o.__isDragging)&&o.options.scrollingComplete(),o.scrollTo(o.__scrollLeft,o.__scrollTop,!0,o.__zoomLevel),o.__refreshActive&&(o.__refreshActive=!1,o.__refreshDeactivate&&o.__refreshDeactivate()))),o.__positions.length=0}},__publish:function(e,o,t,_){var i=this,l=i.__isAnimating;if(l&&(S.stop(l),i.__isAnimating=!1),_&&i.options.animating){i.__scheduledLeft=e,i.__scheduledTop=o,i.__scheduledZoom=t;var n=i.__scrollLeft,r=i.__scrollTop,a=i.__zoomLevel,c=e-n,s=o-r,p=t-a;i.__isAnimating=S.start(function(e,o,t){t&&(i.__scrollLeft=n+c*e,i.__scrollTop=r+s*e,i.__zoomLevel=a+p*e,i.__callback&&i.__callback(i.__scrollLeft,i.__scrollTop,i.__zoomLevel))},function(e){return i.__isAnimating===e},function(e,o,t){o===i.__isAnimating&&(i.__isAnimating=!1),(i.__didDecelerationComplete||t)&&i.options.scrollingComplete(),i.options.zooming&&(i.__computeScrollMax(),i.__zoomComplete&&(i.__zoomComplete(),i.__zoomComplete=null))},i.options.animationDuration,l?h:u)}else i.__scheduledLeft=i.__scrollLeft=e,i.__scheduledTop=i.__scrollTop=o,i.__scheduledZoom=i.__zoomLevel=t,i.__callback&&i.__callback(e,o,t),i.options.zooming&&(i.__computeScrollMax(),i.__zoomComplete&&(i.__zoomComplete(),i.__zoomComplete=null))},__computeScrollMax:function(e){var o=this;null==e&&(e=o.__zoomLevel),o.__maxScrollLeft=Math.max(o.__contentWidth*e-o.__clientWidth,0),o.__maxScrollTop=Math.max(o.__contentHeight*e-o.__clientHeight,0)},__startDeceleration:function(e){var _=this;if(_.options.paging){var o=Math.max(Math.min(_.__scrollLeft,_.__maxScrollLeft),0),t=Math.max(Math.min(_.__scrollTop,_.__maxScrollTop),0),i=_.__clientWidth,l=_.__clientHeight;_.__minDecelerationScrollLeft=Math.floor(o/i)*i,_.__minDecelerationScrollTop=Math.floor(t/l)*l,_.__maxDecelerationScrollLeft=Math.ceil(o/i)*i,_.__maxDecelerationScrollTop=Math.ceil(t/l)*l}else _.__minDecelerationScrollLeft=0,_.__minDecelerationScrollTop=0,_.__maxDecelerationScrollLeft=_.__maxScrollLeft,_.__maxDecelerationScrollTop=_.__maxScrollTop;var n=_.options.snapping?4:.001;_.__isDecelerating=S.start(function(e,o,t){_.__stepThroughDeceleration(t)},function(){var e=Math.abs(_.__decelerationVelocityX)>=n||Math.abs(_.__decelerationVelocityY)>=n;return e||(_.__didDecelerationComplete=!0),e},function(e,o,t){_.__isDecelerating=!1,_.__didDecelerationComplete&&_.options.scrollingComplete(),_.scrollTo(_.__scrollLeft,_.__scrollTop,_.options.snapping)})},__stepThroughDeceleration:function(e){var o=this,t=o.__scrollLeft+o.__decelerationVelocityX,_=o.__scrollTop+o.__decelerationVelocityY;if(!o.options.bouncing){var i=Math.max(Math.min(o.__maxDecelerationScrollLeft,t),o.__minDecelerationScrollLeft);i!==t&&(t=i,o.__decelerationVelocityX=0);var l=Math.max(Math.min(o.__maxDecelerationScrollTop,_),o.__minDecelerationScrollTop);l!==_&&(_=l,o.__decelerationVelocityY=0)}if(e?o.__publish(t,_,o.__zoomLevel):(o.__scrollLeft=t,o.__scrollTop=_),!o.options.paging){o.__decelerationVelocityX*=.95,o.__decelerationVelocityY*=.95}if(o.options.bouncing){var n=0,r=0,a=o.options.penetrationDeceleration,c=o.options.penetrationAcceleration;t<o.__minDecelerationScrollLeft?n=o.__minDecelerationScrollLeft-t:t>o.__maxDecelerationScrollLeft&&(n=o.__maxDecelerationScrollLeft-t),_<o.__minDecelerationScrollTop?r=o.__minDecelerationScrollTop-_:_>o.__maxDecelerationScrollTop&&(r=o.__maxDecelerationScrollTop-_),0!==n&&(n*o.__decelerationVelocityX<=0?o.__decelerationVelocityX+=n*a:o.__decelerationVelocityX=n*c),0!==r&&(r*o.__decelerationVelocityY<=0?o.__decelerationVelocityY+=r*a:o.__decelerationVelocityY=r*c)}}};for(var l in i)o.prototype[l]=i[l];var n=o;e.default=n,e.Animate=S});
//# sourceMappingURL=scroller.min.js.map